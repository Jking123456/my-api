<!DOCTYPE html>
<html>
<head>
    <title>PRINZVAN ADMIN V2</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { background: #0a0a0a; color: #00ff00; font-family: monospace; padding: 20px; }
        .container { max-width: 600px; margin: auto; border: 1px solid #00ff00; padding: 20px; background: #111; }
        input, button { width: 100%; padding: 10px; margin: 5px 0; background: #000; border: 1px solid #00ff00; color: #00ff00; }
        button { background: #00ff00; color: #000; font-weight: bold; cursor: pointer; }
        .card { border: 1px solid #333; padding: 10px; margin-top: 20px; background: #050505; }
        .device-item { font-size: 12px; border-bottom: 1px solid #222; padding: 5px; display: flex; justify-content: space-between; }
        .ban-btn { width: auto; background: #ff4444; color: white; padding: 2px 8px; font-size: 10px; border: none; }
    </style>
</head>
<body>
    <div class="container">
        <h2>üîë GENERATOR</h2>
        <input type="password" id="sec" placeholder="Admin Secret">
        <input type="number" id="days" placeholder="Days">
        <input type="number" id="max" placeholder="Max Devices">
        <button onclick="gen()">Generate Key</button>

        <div class="card">
            <h2>üîç MONITOR KEY</h2>
            <input type="text" id="inspectKey" placeholder="Paste License to Check">
            <button onclick="checkKey()">Inspect Devices</button>
            <div id="monitorResult"></div>
        </div>

        <div class="card">
            <h2>üö´ BAN MANAGEMENT</h2>
            <input type="text" id="banId" placeholder="Hardware ID (HWID)">
            <button style="background:red;color:white" onclick="block('add')">BAN DEVICE</button>
            <button onclick="block('remove')">UNBAN DEVICE</button>
        </div>
    </div>

    <script>
        async function gen() {
            const s = document.getElementById('sec').value;
            const res = await fetch(`/api/generate?days=${document.getElementById('days').value}&max=${document.getElementById('max').value}&secret=${s}`);
            const data = await res.json();
            alert("Key: " + data.license);
        }

        async function checkKey() {
            const key = document.getElementById('inspectKey').value;
            const s = document.getElementById('sec').value;
            // We use the existing script API but with a special query to just "GET" info
            const res = await fetch(`/api/delete?license=${key}&secret=${s}&action=info`);
            const data = await res.json();
            
            let html = `<b>Expiry:</b> ${data.expiry}<br><b>Devices (${data.hwids.length}/${data.max}):</b><br>`;
            data.hwids.forEach(id => {
                html += `<div class="device-item">${id} <button class="ban-btn" onclick="copyAndBan('${id}')">BAN</button></div>`;
            });
            document.getElementById('monitorResult').innerHTML = html;
        }

        function copyAndBan(id) {
            document.getElementById('banId').value = id;
            alert("ID Copied to Ban Section!");
        }

        async function block(action) {
            const id = document.getElementById('banId').value;
            const s = document.getElementById('sec').value;
            const res = await fetch(`/api/block?hwid=${id}&action=${action}&secret=${s}`);
            const data = await res.json();
            alert(data.msg);
        }
    </script>
</body>
</html>
